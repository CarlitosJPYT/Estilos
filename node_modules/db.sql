CREATE DATABASE MAIN;
USE MAIN;

CREATE TABLE Students (
    student_id BIGINT(10) PRIMARY KEY NOT NULL UNIQUE,
    name VARCHAR(100) NOT NULL,
    birthdate DATETIME NOT NULL
);

CREATE TABLE Groupe (
    group_id BIGINT(10) PRIMARY KEY NOT NULL,
    name VARCHAR(100) NOT NULL,
    class_id BIGINT(10) NOT NULL,
    FOREIGN KEY (class_id) REFERENCES Classes(class_id) ON DELETE NO ACTION ON UPDATE NO ACTION
);

CREATE TABLE StudentInGroup (
    id_user BIGINT(10) NOT NULL,
    ide_group BIGINT(10) NOT NULL,
    FOREIGN KEY (id_user) REFERENCES Students(student_id) ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY (ide_group) REFERENCES Groupe(group_id) ON DELETE NO ACTION ON UPDATE NO ACTION
);

CREATE TABLE Teachers (
    Teachers_id BIGINT(10) PRIMARY KEY NOT NULL,
    name VARCHAR(100) NOT NULL,
    birthdate DATETIME NOT NULL,
    group_id BIGINT(10) NOT NULL,
    FOREIGN KEY (group_id) REFERENCES Groupe(group_id) ON DELETE NO ACTION ON UPDATE NO ACTION
);

CREATE TABLE Class (class_id BIGINT(10) PRIMARY KEY NOT NULL, number VARCHAR(5) NOT NULL);

CREATE TABLE Cousers (
    course_id BIGINT(10) PRIMARY KEY NOT NULL,
    name VARCHAR(100) NOT NULL,
);

CREATE TABLE TeacherToCouser (
    student_id BIGINT NOT NULL,
    couser_id BIGINT NOT NULL,
    FOREIGN KEY (student_id) REFERENCES Teachers(Teachers_id) ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY (couser_id) REFERENCES Cousers(course_id) ON DELETE NO ACTION ON UPDATE NO ACTION
);

SELECT
    Students.student_id,
    Students.name AS student_name,
    Students.birthdate,
    GROUP_CONCAT(Groupe.name SEPARATOR ', ') AS group_names
FROM
    Students
LEFT JOIN
    StudentInGroup ON Students.student_id = StudentInGroup.id_user
LEFT JOIN
    Groupe ON StudentInGroup.ide_group = Groupe.group_id
GROUP BY
    Students.student_id, Students.name, Students.birthdate;